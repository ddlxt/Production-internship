# 软件工程课程智能学习助手系统 需求规格说明书

## 项目目标

本项目旨在为软件工程课程打造一款智能学习助手系统，利用先进的人工智能技术提升教学与学习体验。系统将通过集成大型语言模型（Large Language Model, LLM，如GPT-4o/deepseek）的API提供核心智能问答和辅助能力，帮助学生深入理解课程内容、辅助教师减轻重复性工作。该系统特别强调检索增强生成（Retrieval-Augmented Generation, RAG）和多智能体协作，以确保回答准确性和功能多样性。通过引用课程教材、教师资料等权威知识库内容，结合多个专职智能体的配合，系统将实现更高质量的答疑、自动批改和项目辅导，全面支持软件工程课程的教学目标。

### 本系统的设计遵循以下总体目标：

智能助教功能：提供类似助教的智能问答与指导服务，能够回答学生关于软件工程课程的各种问题，解释概念、辅导作业，并给出学习建议。
提高教学效率：自动执行或协助完成部分教学相关任务（如批改作业、撰写文档初稿、检查格式等），减少教师负担，让教师将更多精力投入个性化教学。
个性化学习支持：根据学生的学习情况提供定制化的反馈和建议，帮助学生发现不足、巩固知识，提升学习效果。
促进实践能力：辅助学生在课程项目中进行需求分析、设计建模、编码和测试等实践环节，通过智能体工具提供指导和即时反馈，培养软件工程实践能力。
创新教学模式：采用多轮对话、人机互动的教学方式，利用多智能体系统带来的专业分工和协同推理优势，探索软件工程课程的智能教学新模式。多智能体架构带来**专业专注**（每个智能体专注特定任务）、**协同推理**（智能体合作提高问题解决的全面性）、**动态交互**（智能体相互交流优化答案）、**可扩展性**（可按需增加新功能智能体）等优点，使系统更加强大灵活。

## 功能需求

本章节详细描述系统所需实现的功能。
* **自然语言智能问答与指导**：系统应能通过调用GPT-o4 mini等LLM模型，理解并用自然语言回答学生提出的问题，提供指导和解析。例如，解释软件工程概念（如面向对象设计原则）、解答作业中的疑问，或指导学生完成某项任务。同时对于教师而言，可以通过大语言模型实现作业批改，减轻教师负担。另外，每次回答应当准确、有条理，并能结合课程内容给予恰当的示例或解释。

* **检索增强回答（RAG机制）**：系统需要构建课程专属知识库，并在回答问题或批改作业时利用检索增强生成机制。具体而言，系统应从**教材PDF**、**教师上传的课件/参考资料**、**作业标准答案**等资料中检索出与当前问题相关的内容，将其作为辅助信息注入LLM的提示中，从而提高回答的准确性和依据。该功能确保AI回答依据权威资料（如教材原文或教师提供的答案要点），降低错答或幻觉现象，提升问答质量和自动批改的可靠性。为每个课程建立独立的知识库，每个课程的知识库包括教师上传的课件/参考资料、作业以及相应的参考答案。

* **多智能体协作**：系统由一组解耦的智能代理（约10个）组成，每个智能体负责一种特定功能，协同满足软件工程课程教学的需求。主要智能体及其职能包括（详见“智能体角色分工”章节）：

  * 需求文档撰写助手
  * 类图生成助手(使用mermaid插件)
  * 项目管理助手
  * 代码审查助手
  * 软件测试设计助手
  * 文档格式检查助手
  * 进度追踪助手
  * 学习建议助手
  * 教学数据反馈助手
  * 答疑讲解助手

  各智能体分别承担从需求分析、设计、编码到测试、反馈等不同环节的辅助工作，覆盖软件工程课程实践的全流程。系统应支持用户明确指定调用某一类功能（例如让“代码审查助手”检查一段代码），或由系统调度在后台自动选择合适的智能体合作完成复杂任务。

* **多轮对话与上下文保持**：系统需提供对话式交互界面，支持用户与AI进行**多轮对话**。在会话过程中，系统应保持对上下文的记忆：理解前序对话内容，允许用户在不重复背景的情况下进行追问或进一步请求。例如，学生可以先询问“什么是设计模式中的工厂模式？”，得到解释后，再问“能举一个工厂模式在本课程项目中的应用实例吗？”，系统应理解第二问延续了前一问题的上下文，从而给出相关联的回答。为实现上下文保持，系统可能需要维护对话状态或利用LLM的大上下文窗口，将历史对话摘要或重要信息作为系统提示的一部分。无论实现方式如何，功能上要求系统在整个对话中具有连贯性和记忆能力，不因多轮交互而丢失关键背景。

* **可视化反馈**：系统应能根据需要提供可视化的输出结果，辅助教学和理解。这包括但不限于：

  * **图表与图形展示**：针对数据分析结果或进度统计，系统可以生成简单的图表（例如进度折线图、成绩分布饼图）给教师或学生查看。
  * **UML类图/流程图生成**：在讨论软件设计时，系统通过“类图生成助手”或相关智能体，将文本描述转换为UML类图、用例图、流程图等，并以图片形式展示给用户。
  * **代码片段高亮**：当提供代码审查反馈或代码示例时，系统界面应支持代码高亮显示，提升可读性。

  可视化反馈功能要求系统能够与绘图或渲染工具集成，利用Mermaid根据智能体生成的描述自动绘制图形，然后呈现在对话中。这将有助于学生对抽象概念或设计方案的理解，也便于教师查看分析结果。

* **作业管理支持**：虽然本系统以智能学习助手为核心，但仍需保留常规作业管理的基础功能，作为教学配套支持：

  * **学生提交作业**：提供学生上传作业（文本、代码或文档）的接口，并存储提交记录。可以与现有课程管理系统对接，或在本系统中简单实现提交记录功能。
  * **教师批改与评阅**：教师能够查看学生提交并给出评分和反馈。同时，教师可以选择启用AI协助批改：根据教师上传参考答案对学生提交的作业进行批改并生成相应的成绩和评语。最终评分和评价以教师确认为准。
  * **错因智能讲解**：对于学生错误的答案或低得分的作业，系统可在教师批改后或学生查看成绩时提供AI讲解功能。由“答疑讲解助手”结合该题的标准答案和学生作答，生成针对性的讲解，指出错误原因、缺漏内容，并引导学生理解正确解法。这一功能作为对教师反馈的补充，帮助学生从错误中学习。

上述作业系统相关功能应当以配套支持形式存在，不喧宾夺主。即核心仍然是智能助手的交互与指导功能，这些作业管理功能更多是为了方便将AI助手融入课程作业流程。必要时可以与学校现有学习管理系统（LMS）进行集成对接，而无需全部从头开发。

## 系统架构

本系统采用模块化的分层架构，以支持多智能体的协作和RAG机制的高效运行，保证小型开发团队也能实现和维护。主要架构组件包括：

* **用户界面（UI）**：提供学生和教师与系统交互的入口，使用网页搭建，前端技术栈为Voe3+ts，前端UI作为用户代理，提供用户与大模型交互的的界面。UI负责多轮对话的显示与输入，支持文本、代码及多媒体内容的呈现。界面应直观易用，例如聊天窗口显示双方对话，支持富文本和图片（用于展示图表/UML等）。对于作业提交和批改，UI也应提供相应界面或入口（如上传按钮、评分查看页面）。UI层通过后端API与业务逻辑通信，将用户请求发送给调度模块处理，并将AI返回结果实时展示。

* **对话与上下文管理**：后端和文件系统需要维护每个会话的上下文数据。可在后端为每个用户会话创建会话ID和状态，用于存储历史对话记录。大语言模型需要向官方版本一样支持多轮对话记忆。

* **智能体模块**：围绕调度模块部署的独立功能组件，每个智能体模块封装一种专长能力（参见下一章节详细列表）。在实现上，根据不同功能需要，不同的智能体使用不同的基础模型和不同的系统提示词以及不同的知识库进行封装。例如，“类图生成助手”模块可能将需求描述转换为Mermaid语法然后调用绘图引擎生成图；“代码审查助手”模块会调用LLM分析代码片段并输出反馈。在架构层面，各智能体应通过明确定义的接口与调度模块交互，输入为指定格式的任务请求（包含必要上下文），输出为结构化的结果数据或文本。智能体模块自身也可以访问知识库检索接口（如果某任务需要查询课程资料，例如“教学数据反馈助手”可能检索过往成绩数据进行分析）。

* **知识库及检索模块**：存储和提供课程相关知识的子系统，是实现RAG的关键部分。知识库由结构化和非结构化数据组成，包括：

  * **教材与资料库**：课程指定教材的英文PDF内容，教师上传的讲义、参考文献、示例代码、常见问题解答等文档。这些文档在系统部署时或运行中由教师维护导入。需要经过文本抽取、清洗和分段处理，并使用**向量嵌入**技术将段落索引到向量数据库中，以支持相似度检索。
  * **作业与答案库**：历年或当前课程的作业题目及标准答案、优秀学生解答示例等，也可以纳入知识库。这有助于AI在回答与作业相关的问题或进行自动批改时参考正确答案要点和评分标准。
  * **课程Q\&A库**（可选）：如果课程已积累常见问答对（例如往届助教整理的FAQ），也可录入为FAQ知识对，以便AI快速匹配常见问题的权威答案。

  检索模块对接知识库，为调度模块或智能体提供检索服务：接受查询（通常由用户问题或需要分析的文本提取关键词向量表示）并返回相关内容片段列表。返回内容应附带来源标识（如出处教材章节或资料文件名），以供AI回答时引用或辅助解释。知识库需要定期更新和扩充，例如教师上传新资料后重新索引嵌入。为了系统性能和小团队开发可行性，可使用现有开源方案构建该模块（FAISS向量数据库配合LangChain/LlamaIndex等工具），避免从头实现复杂检索算法。

* **LLM API集成**：系统的核心AI能力由外部大型语言模型提供，这里拟采用第三方的集成API接口，避免了需要为每个大模型设置不同API。LLM集成模块封装与OpenAI等提供商的API通信，负责将调度模块整理的提示（prompt）发送给模型，获取生成结果。

* **数据存储**：系统需要若干数据存储来支撑各功能模块：

  * **用户数据存储**：存储学生、教师的账户信息，权限角色，token(使用token提高系统安全性）以及课程相关的数据（如学生作业成绩、项目选题等）。
  * **对话记录存储**：保存对话日志和AI给出的反馈，持久性存储，方便调用与查看。
  * **作业及评估存储**：存储作业提交内容、批改结果（评分、评语）、AI生成的讲解反馈等，以供教师和学生查阅历史记录。
  * **知识库数据**：如上所述，课程资料文本及其向量索引；可存储于数据库或文件系统中，并确保可以方便地更新重建索引。

整体架构可以视为**多层次协同**：前端UI与对话管理提供人机交互界面，中间的调度模块串联LLM、知识检索和智能体，实现业务逻辑；底层由知识库和数据存储支撑内容供给。借鉴OpenAI、微软、Anthropic等公司的实践经验，我们在架构中遵循**模块解耦、职责单一**原则，各部分通过清晰接口集成。这不仅让系统具备扩展性（例如未来替换LLM提供商，或增加新的智能体），也降低了开发复杂度，适合由一个小型团队并行开发各模块、最终集成调试。

## 智能体角色分工

本系统设计了约十个智能体（AI Agent），对应软件工程课程中的不同辅助功能领域。每个智能体在其职责范围内自主调用LLM或专用算法完成任务，并由调度模块统一协调它们为用户提供服务。以下列出各智能体名称和功能说明：

1. **需求文档撰写助手**：协助用户撰写和完善软件需求规格说明（SRS）等文档。该智能体能够根据用户提供的项目背景或要点，给出文档结构建议，提醒需求描述的完整性。一方面，它可以针对既有文档进行审阅，指出缺失的章节或不明确的需求条目；另一方面，也能根据简单的输入生成需求文档初稿供学生参考。此助手确保学生在课程项目早期就掌握正确的需求分析和文档撰写方法。

2. **类图生成助手**：根据文字说明、用户提供的代码片段或交互对话内容，自动生成对应的UML类图或相关设计图。该智能体解析输入的描述（例如类的属性和方法、类之间关系），构建标准UML表示，并以图形方式输出。这有助于学生将抽象的软件设计转换为直观的模型图，提高对面向对象设计和建模的理解。在后台实现上，它可能借助Mermaid等工具绘制图形并返回可视化结果。

3. **项目管理助手**：为课程项目提供计划和跟踪支持。它可以帮助学生分解项目任务、制定项目进度表，推荐常用的敏捷工具或实践（如Scrum待办事项列表）。学生可以咨询如何安排里程碑，如何分配团队成员的任务，项目管理助手会给予相应建议。运行期间，它还可跟踪项目进展（结合进度追踪助手的数据），提醒学生关键截止日期临近、未完成任务等。对于教师，该助手能提供班级整体项目的进度概览，便于及时干预辅导。

4. **代码审查助手**：自动化的代码评审智能体。学生在练习或项目中提交代码后，可以请此助手进行审查。它会检查代码风格规范（如命名、注释、格式）、可能的错误和bug、潜在的性能问题，以及是否遵循课程教授的编码最佳实践。输出将包含对问题的具体指明和改进建议，帮助学生及时改进代码质量。教师也可借助该助手在批改编程作业时快速发现重点问题。由于GPT-4具有强大的代码理解和生成能力，通过适当的提示工程，此智能体能够给出接近人工审查质量的反馈。

5. **软件测试设计助手**：帮助学生为其软件设计和代码编写测试方案。学生可以告知该助手软件模块的功能描述，助手将建议相应的测试用例，包括正常情况和边界条件、异常情况等。它也能检查学生自己设计的测试用例集是否充分，提示遗漏的重要测试情景。通过这一功能，学生将加强对软件测试重要性的认识，学习如何系统地设计高质量测试，从而提高代码可靠性。教师可以利用该助手自动生成一些测试案例，用于验证学生项目的功能正确性。

6. **文档格式检查助手**：负责审查学生提交文档的格式和规范符合性。无论是需求规格说明书、项目报告，还是论文式作业，该智能体都能根据预先设定的格式要求或模板，对文档进行检查。它将标记如：排版不一致、标题层次混乱、参考文献格式错误、图表未按要求标注等问题，并提供修改建议。这确保学生提交的文档不仅内容正确，而且形式规范，符合软件工程专业写作要求。教师可在最终评分前参考此助手的检查结果，快速发现格式问题。

7. **进度追踪助手**：针对学生个人或团队在课程中的学习与项目进展情况进行监控和提示的智能体。它会综合分析数据（如各次作业的提交时间、分数，项目各阶段里程碑完成情况等）来跟踪进度。如果发现某学生连续多次作业延交或成绩不理想，助手可以提醒学生注意时间管理或寻求帮助；对于团队项目，它能指出当前进度滞后的环节。教师界面则可通过该助手查看全班整体进度统计，识别普遍延迟的任务或困难点，从而及时在课堂上重申或调整安排。进度追踪助手有效促进按时完成任务的习惯养成，并为教学提供数据支持。

8. **学习建议助手**：提供个性化学习建议的智能体。基于学生的历史表现、学习习惯和兴趣领域，它可以定制推荐一些补充资源、练习或改进行动。例如，若某学生在单元测试相关作业中表现不佳，助手会建议其复习相应章节内容并提供额外练习题；又如学生对某前沿主题（微服务架构等）表现出兴趣，助手可推荐难度适宜的扩展阅读材料。建议将以温馨鼓励的语气提供，重点在于帮助学生自主改进。此功能实现因材施教的理念，增进学习动力和成就感。

9. **教学数据反馈助手**：面向教师的智能分析助手。它定期或按需汇总课程教学相关的数据，向教师提供可视化的报告和洞察。例如：各次作业的平均得分和分布、常见错误的统计、高频提问的知识点、学生对不同教学环节的反馈（可能来自问卷或讨论帖的数据）等。通过这些汇总，教师可以了解哪些知识点大部分学生已经掌握，哪些是薄弱环节；判断作业难度设置是否合理；课程进度安排是否需要调整等。这一助手相当于教师的“数据参谋”，帮助教师基于客观数据改进教学策略，提升课程质量。

10. **答疑讲解助手**：充当课程的问答解惑智能导师。它可以实时回答学生围绕课程内容提出的各种问题，包括理论概念、实践方法、工具使用等方面。同时，在学生完成作业或考试后，对于做错的题目，学生可询问该助手获取详细讲解。答疑讲解助手会结合标准答案和课程知识，耐心解释正确解题思路、关键考点，并指明学生解答中的误区。这不仅纠正了一次问题，更帮助学生举一反三、融会贯通。由于该助手基于课程知识库运作，它的回答始终与课程教材和教师讲解保持一致，是学生课后自学的得力助手。

上述智能体各司其职，又在调度模块的协调下协同工作，共同形成对学生和教师的全面支持。例如，当学生就一个课程项目问题进行咨询时，多个智能体可能先后参与：答疑助手先解释概念，类图助手提供设计图示例，代码审查助手给出实现建议，项目管理助手提醒相关任务安排，最终整合成系统回复。这样的分工与合作确保了系统回答的专业深度和广度。

## 知识库构建策略

知识库是智能学习助手系统的知识源泉，对实现RAG机制至关重要。本系统将构建一个专门面向软件工程课程的知识库，汇聚权威教材内容和教学资料，采用有效的加工和索引策略，以便为LLM提供高质量的上下文支持。知识库的构建和维护策略如下：

* **资料收集与分类**：首先确定知识库的内容范围和来源：

  * 核心教材：指定的教材PDF全文。例如《软件工程导论（第六版）》（张海藩）、《软件工程》（朴勇）、《软件工程》（鄂大伟）等。其中，《软件工程导论（第六版）》（张海藩）这部分是主要理论基础。
  * 教师资料：由任课教师提供的课件幻灯片、讲义、例题、阅读资料、实验指导、往年试题等。这些资料通常直接反映课程重点和授课内容，是教材的重要补充。
  * 作业及解答：课程布置的作业题目、项目说明，以及教师编写的参考答案或评分细则。

  收集到的资料按类别、来源进行分类整理，以便后续处理和检索。教材按章节拆分，讲义按周次或主题区分，作业按次序编号等进行划分。

* **向量嵌入索引**：利用向量检索技术为知识库建立索引。选择预训练的文本嵌入模型，将每个知识段落转换为向量表示，并存储在高效的向量数据库中（FAISS）。向量维度视模型而定，一般数百维。向量索引允许在用户提出问题时，将问题或相关文本转换为向量，与库中向量计算相似度，快速找出最相关的几个段落。这一**Dense Retrieval**方式对语义匹配效果较佳，能够找到与问题相关但未必字面包含关键词的内容。相比传统关键词搜索，嵌入检索提高了召回正确知识的概率。

* **检索触发策略**：定义系统在何种情况下调用知识库检索，以及如何将结果提供给LLM：

  * 对于**学生提问**和**概念性对话**，默认触发知识检索，以确保回答严谨。例如学生问“什么是ISO/IEC 12207软件生命周期标准？”时，系统应检索教材/讲义中对应解释段落，让LLM参考回答。
  * 对于**作业批改**场景，当AI需要判断学生答案正确性时，也应检索相关标准答案段落或教材理论依据，以对比学生答案。这样AI批改时有依据可循，不凭空主观判断。
  * 对于**代码审查**或**设计类问题**，主要依赖LLM逻辑推理，但如果识别出问题涉及定义性知识（如某设计模式的定义），也可检索定义段落提供给LLM增加可靠性。
  * 调度模块应在每次LLM调用前，根据当前任务类型决定是否检索及选取多少结果（例如选取Top 3相关段落），并将检索结果附加在Prompt中。Prompt格式可以是在系统消息中加入知识片段引用或以“参考资料:”附加，让LLM在生成回答时综合考虑。模型生成的回答可能会引用这些资料进行佐证，甚至直接从中摘取关键公式或定义，从而保证专业准确性。

* **知识库更新维护**：为了保持知识库与课程内容同步，需制定更新机制：

  * 教师能够在课程期间持续上传新资料（新的作业题目、补充讲义等），系统应提供工具重新对新增文档进行预处理和索引更新。可以采用定期批处理，也可即时更新（小规模资料增量更新向量索引）。

* **权限与引用**：知识库内部分资料可能涉及版权或机密（如未公开的试题答案）。系统在使用这些内容时应当考虑权限：

  * 对学生的问题，AI回答时可以引用教材和已公开资料内容，但不应直接泄露教师仅供参考的评分细则或标准答案原文，除非问题明确要求解释该题答案且在作业截止后。
  * 教师可以查看知识库的所有内容，但学生界面对敏感资料可能要屏蔽直接获取，只能经由AI消化后反馈。所以知识库检索模块应结合用户角色和内容敏感度，决定检索结果是否可用于回答或需要过滤。

通过上述策略，知识库将成为本系统知识智能的基石。在实现过程中借鉴大厂实践（如Anthropic的**Contextual Retrieval**方法、OpenAI Plugin中的检索方案），确保知识库构建的质量，同时充分利用开源工具降低开发工作量。RAG机制的最终目标是让AI始终“有据可依”，在复杂问答和批改任务中体现出对课程内容的深刻理解和权威性。

## 非功能需求

除了上述功能性需求外，系统还必须满足一系列非功能性要求，以保证实际使用中的性能、可靠性、安全和用户体验。这些要求包括：

* **性能和并发性**：系统应能够支持班级规模的并发使用，例如同时有几十名学生与助手对话或请求服务而不明显降速。通常每次提问回答的响应时间应控制在几秒到几十秒内（具体取决于LLM响应时间和检索开销），对于复杂任务（如生成大型文档）也应在合理时间内完成。调度模块需要高效异步调度，充分利用并行能力和后端资源，以减少等待。对于高并发可能需要队列和请求调度策略，确保系统不会因瞬时请求高峰而崩溃。

* **可用性和健壮性**：系统应具备高可用性，避免单点故障。各组件失败时应有降级方案，例如知识库检索服务不可用时，系统至少能退化为仅LLM回答模式；某个智能体出错时，调度模块应捕获异常并向用户友好提示错误而非无限等待。系统需经过充足测试（包括单元、集成和用户测试）以确保稳定。对于核心学习环节（如学生在紧急求助或考试复习时使用），系统的可靠运行尤为关键，应提供必要的监控和报警机制来及时处理问题。

* **可扩展性**：设计需支持日后功能扩充和性能扩展。功能上，可扩展性体现在易于添加新的智能体模块或更换LLM提供商。例如如果以后引入一个“算法辅导助手”或采用Anthropic的模型，系统架构应尽量无需大改即可集成。性能上，可扩展性意味着可以通过水平扩容服务器、扩展向量数据库分片等方式提升吞吐能力，以支持更多并发用户或更庞大的知识库。这要求模块之间低耦合，以及采用可伸缩的技术栈（如云服务部署、多线程异步处理等）。

* **易用性（UX/UI）**：针对学生和教师用户，系统界面和交互应简洁友好：

  * 聊天交互应自然流畅，使用户感觉就像在与人对话。对话窗口布局清晰、消息显示格式美观（代码片段、引用资料、图表均合理展示）。
  * 智能体功能的调用要直观，最好大部分情况用户不必指定具体哪个智能体——由系统自动完成复杂任务。仅在高级用法或调试时，用户才需要明确选择某助手。
  * 对于需要用户输入较多信息的功能（如需求文档生成可能要先提供项目背景），界面可引导分步输入，而非一次性让用户提供所有信息，以减轻认知负担。
  * 教师查看数据报表或学生进展时，仪表板设计应图文并茂、一目了然，让非技术背景的教师也能轻松解读AI提供的分析。
  * 提供必要的帮助提示和说明，例如在界面适当位置解释AI建议的参考价值、提示用户提问时如何表述获得最佳效果等，提高用户满意度。

* **准确性与可靠性**：作为教学助手，系统提供的信息和建议务必正确可靠。这不仅依赖于模型本身的性能，更需要通过RAG等机制校准答案。在非功能角度，我们要求：

  * 答案准确率高：AI对课程相关问题的回答正确率应达到高水平（理想情况>=90%）。对于重要概念或作业批改，错误回答可能误导学生，须尽量避免。实现上可考虑在部署前针对常见问题进行验证，识别模型弱点并通过额外提示修正。
  * 解释可信度：当AI给出答案尤其是批改判定时，最好能提供一定理由或依据，提高说服力。例如：“您的答案缺少关键点X，因为根据教材第3章...”。这样的回答让师生更放心AI结论的可信度。
  * 模型输出一致性：尽管LLM具有随机性，但对于相同问题在相似上下文下输出应大致一致，不应前后矛盾。这需要在提示设计和参数设定（如温度）上加以控制，确保系统行为稳定。

* **维护性**：小团队开发和维护要求代码清晰、结构合理，方便后续修改升级。模块化设计已经为维护性打下基础，实现时还应：

  * 为各模块撰写详细文档，包括智能体提示配置、知识库更新流程、系统部署说明等，便于新人加入或接手。
  * 关键部分添加日志和可观测性手段（如对话流程日志、检索调用日志），方便调试定位问题、监控模型效果。
  * 有计划地管理技术债，定期评估替换过时组件或优化低效部分，保证系统可持续演进。

* **兼容性**：系统应考虑运行环境的兼容，包括:

  * 浏览器兼容（前端应支持主流浏览器，以方便学生访问）。
  * 不同屏幕尺寸适配（考虑移动端使用场景，聊天界面在手机上也应易用）。
  * 后端组件容器化部署，能够在学校已有基础设施或云环境平滑运行。
  * API的版本兼容：调用外部LLM API或第三方库时，应设计抽象层，以便API版本升级或切换时对上层影响较小。

综上，非功能需求确保本系统不仅“能用”，而且在真实教学环境中“好用”、“耐用”、“安全可靠”。这些质量指标的达成同样需要在开发过程中引起重视，并通过测试和反馈持续改进。


## 关键用例场景

下面通过典型用例场景，说明智能作业助手的工作流程和用户交互。

**用例场景1：学生提交作业并获得AI批改反馈**

1. **教师布置作业**：教师登录系统后新建一个作业任务“课堂练习1”，填写作业要求和截止日期，并上传标准答案作为评分参考。发布后，该作业对班上学生可见。
2. **学生查看并完成作业**：学生A登录后在“作业列表”中看到了“课堂练习1”，了解要求和截止日期。在完成过程中，学生A如果遇到困难，可以点击“AI助手”按钮询问提示。例如，他不理解第2题的问题，就请求AI给一些解题思路。AI提示智能体检索知识库后，建议了相关公式和解题方向，而未直接给出答案。学生A参考提示顺利完成了作业。
3. **学生提交答案**：学生A在系统中填写了各题答案，并上传了一张手写演算稿的照片作为附件，一并提交。系统显示“提交成功”，该作业状态更新为“已提交，待批改”。教师端收到学生A提交的通知。
4. **教师发起AI批改**：截止日期过后，教师进入“课堂练习1”的批改界面，看到班级多数学生已提交作业（系统统计提交率为90%）。教师点击“智能批改”按钮，后端批改模块将本次所有学生答案打包发送MCP模块请求AI批改。
5. **AI自动批改**：MCP模块的批改智能体逐份评阅学生答案：先由检索器从知识库调取相应题目的参考要点，然后调用大模型对比学生答案与参考答案，给出每题的判分和评语建议。系统很快生成了包括学生A在内的所有提交的初步评分和反馈。对于学生A，AI判定其第2题答案有一个关键步骤错误，扣除了2分，并在反馈中详细说明了错误原因。
6. **教师复核调整**：教师查看学生A等人的AI批改结果，对于AI给出的评语和分数基本认可。但教师发现AI没有识别学生A上传的手写稿中一个正确思路，导致第3题少给了1分。于是教师在系统界面调整了学生A第3题得分，并在反馈中补充说明“手写计算过程正确，酌情给予该步骤分”。其他学生的批改结果教师也一一浏览，必要时做了调整。
7. **发布反馈**：教师确认所有学生的批改结果无误后，点击“发布成绩”。系统将最终成绩和反馈保存，并通知学生端。
8. **学生查看反馈**：学生A再次登录系统，在“我的作业”中看到“课堂练习1”状态变为“已批改”。他点进详情，查看了自己的得分以及AI+老师给出的逐题反馈。他发现第2题自己遗漏了一处关键步骤，反馈写明了正确方法；第3题老师特别备注了手写演算得分情况。
9. **学生追问AI辅导**：学生A对第2题的错误还是有些疑惑，便使用作业详情页的“询问AI”功能，提问：“我在第2题哪个步骤出了问题？应该怎么做？”AI讲解智能体接收到问题，结合学生A的解答和参考答案，详细解释了第2题所涉及的物理定律，并指出了他在第2步推导时的误解。学生A经过这一对话辅导彻底明白了错误原因。

**用例场景2：学生使用智能体完成软件设计作业**

1. **教师布置设计作业**：软件工程课程的教师发布了一个"在线书店系统设计"作业，要求学生完成需求分析文档和系统类图设计。教师在作业要求中明确了评分标准，包括需求完整性、类图规范性和设计合理性等维度。

2. **学生初步构思**：学生B登录系统后看到这个设计作业，他对如何撰写标准的需求文档和绘制UML类图感到有些困难。他首先在纸上草拟了一些初步想法和功能点。

3. **求助需求文档生成智能体**：学生B在作业编辑页面点击"AI助手"，并选择"需求文档生成"功能。他将自己草拟的想法输入："我想设计一个在线书店系统，包括用户注册登录、图书浏览、购物车、订单管理和支付功能。"需求文档生成智能体接收请求后，先从知识库检索标准软件需求文档的模板和示例，然后基于学生的初步想法生成了一份结构完整的需求文档框架，包括项目背景、功能需求、非功能需求等章节，并在每个章节提供了详细的指导和示例。

4. **完善需求文档**：学生B根据智能体生成的框架，开始填充具体内容。当他对某些部分不确定时，例如"如何描述系统性能需求"，他会向AI提问。AI根据软件工程知识库中的最佳实践给出建议："性能需求应包含响应时间、并发用户数、吞吐量等具体指标，例如'系统应支持1000名用户同时在线，页面响应时间不超过2秒'。"学生B按照指导完成了需求文档的各个部分。

5. **使用UML类图智能体**：完成需求文档后，学生B需要设计系统的UML类图。他选择"UML类图智能体"功能，并上传了自己的需求文档。智能体分析文档内容，从中提取关键实体和关系，自动生成了初步的类图，包含用户、图书、订单、购物车等核心类及其属性和方法。

6. **交互式类图优化**：学生B查看系统生成的类图，发现购物车与订单的关系不够明确。他向AI提问："购物车和订单应该是什么关系？"UML类图智能体解释道："购物车可以转化为订单，建议设计为购物车类有一个'转换为订单'的方法，而不是直接继承关系。"并据此更新了类图。学生B还通过多轮对话，优化了其他类之间的关联和继承关系，最终得到了一个结构合理的UML类图。

7. **设计反馈与改进**：提交前，学生B请AI对整体设计进行评估。代码审查智能体分析其设计后指出："你的用户类缺少密码加密相关属性和方法，这在安全需求中是必要的。"学生B根据反馈，完善了用户类的设计，添加了密码加密相关方法。

8. **提交作业成果**：学生B将最终完成的需求文档和UML类图一起提交到系统。系统显示"提交成功"，作业状态更新为"已提交，待批改"。

9. **教师评阅与AI辅助**：教师查看学生B的作业，同时查看AI批改智能体的评估意见。AI指出学生B的设计符合大部分软件工程规范，特别是在类的职责划分上表现良好，但部分类的属性可能冗余。教师结合AI意见和自己的专业判断，给出了具体评分和改进建议。

10. **学生查看反馈并学习**：学生B收到批改结果后，了解到自己设计中的优点和不足。他通过"询问AI"功能，进一步向AI学习："如何避免类设计中的属性冗余？"AI讲解了数据规范化和单一职责原则的应用，帮助学生B加深对软件设计原则的理解。

通过以上场景可以看出，智能作业助手如何在**作业提交-批改-反馈**的闭环中，提高效率和质量，同时通过**AI多轮对话**为学生提供个性化的学习辅导，真正实现人机协同的智慧教学。


## 安全与数据保护

软件工程课程智能助手系统在处理学生和教师数据，以及连接外部AI服务时，必须优先保障安全和隐私。下面列出本系统在安全和数据保护方面的要求：

* **用户数据隐私**：学生和教师的个人身份信息（姓名、学号/工号、邮箱等）以及学习数据（成绩、提问记录、反馈等）都应严格保护。所有存储的用户数据必须加密传输和妥善保存，避免未授权访问。系统遵循学校或法律规定的数据隐私政策，未经许可不向第三方提供个人数据。特别地，与LLM交互时，要注意不在提示中包含可识别个人的信息，防止泄露隐私到外部模型服务。

* **知识库内容安全**：知识库中包含版权受保护的教材内容和仅供教学内部使用的资料（如试题答案）。系统必须防止未授权用户直接获取这些敏感内容：

  * 接口安全：知识检索接口应受后台控制，不提供开放的内容下载服务。AI回答时如果需要引用教材句子，应当简短引用且只在回答上下文内呈现，不能大段导出教材。
  * 角色权限：根据用户身份过滤知识使用范围。例如学生用户的问题若企图直接索取作业答案全文，AI应予以拒绝或引导，而教师用户查询则可获取完整答案用于参考。
  * 防止滥用：监控系统是否被反复利用来重建教材内容（比如不停询问教材某章节逐段内容），若检测到疑似批量提取行为可予以限制或警告，以保护版权。

* **访问控制**：系统需要实现基本的身份认证与授权：

  * 只有本课程注册的学生和任课教师能登录使用系统对应功能。可与学校统一认证系统对接（如OAuth校园账号登录）或单独管理账户。
  * 功能权限区分：教师有权限查看班级汇总数据、上传资料和管理知识库，而学生无权访问他人成绩或修改知识库等。
  * 管理员角色：可能需要一个系统管理员账号，用于维护系统全局配置（如API密钥、知识库重建），该角色权限应慎重授予，操作需日志记录。

* **数据传输与存储安全**：所有客户端与服务器通信必须通过HTTPS等加密通道，防止中间人攻击窃听对话或敏感数据。服务器端存储的关键数据（如用户密码散列、API密钥、学生成绩）应做好加密或单向哈希。对于对话日志、AI输出等数据，也应妥善存储并定期清理不必要的敏感信息，减少泄露风险面。

* **第三方服务安全**：系统调用外部的大型语言模型API（如OpenAI）时，需要遵循相关服务的使用政策，确保数据安全：

  * 在可能情况下，启用数据不存储选项（OpenAI允许的情况下要求其不将对话数据用于训练）。
  * 避免发送敏感隐私数据到第三方。如果必须处理机密代码或数据，考虑在本地部署模型或通过企业版服务取得数据保护协议。
  * 关注API调用的安全，如密钥保密、访问频率限制等，防范密钥泄露或被滥用。

* **内容安全和伦理**：作为教育系统，需防范AI可能生成的不当内容：

  * 模型有时可能输出不符合教学要求的内容，甚至有不良信息。必须对输出建立**内容过滤**机制，例如利用OpenAI提供的内容审核API或自定义过滤规则，拦截和修正潜在有害输出（如歧视性语言、色情暴力内容等）。
  * 系统应禁止被用于违规用途，例如学生尝试用它直接获取作业答案作为自己的提交。这需要在使用政策或用户指南中明确声明，并在技术上进行一定限制（如对当前尚未到截止时间的作业问题，AI可以提示思路但避免直接给出完整答案）。
  * 伦理方面，AI应保持中立和客观，不应有偏见地对待学生。训练使用的模型虽不是自行开发，但使用中要持续监控其表现，及时反馈给提供商或调整提示，以减少Hallucination和偏见情况。

* **备份与恢复**：制定数据备份策略，尤其是知识库数据和关键教学数据（成绩等）应定期备份，防止意外丢失。同时准备紧急情况下的恢复方案，以便在系统故障或数据损坏时，快速恢复服务，避免影响教学进度。

总之，安全与数据保护贯穿系统设计与实现的始终。鉴于教育领域对数据隐私和内容安全的高要求，本系统将严格按照信息安全最佳实践执行，赢得用户信任，为教学创新提供坚实保障。

## 开发建议与优先级

鉴于本项目涉及技术领域广泛（LLM集成、向量检索、多Agent协同等）且团队规模有限，在开发过程中需要把握重点、循序渐进。本章节提出开发的建议步骤和功能优先级，以提高效率、降低风险：

* **采用成熟框架与服务**：优先选择已有的技术框架以减少重复造轮子：

  * 考虑使用**OpenAI API**提供核心LLM能力，无需自行训练模型，从而将主要精力放在提示工程和业务逻辑上。OpenAI等服务已较稳定，可满足问答和代码生成需求。如有敏感数据顾虑，可选Azure OpenAI（有企业级安全保障）或其他本地大模型方案。
  * 善用现有**多智能体开发框架**，如微软的Semantic Kernel/AutoGen、LangChain Agents等。这些框架提供了编排多个LLM代理的机制，小团队可以在其基础上配置自定义智能体而非完全从零开发。微软AutoGen在教育场景已有示例（如多Agent个性化导师），可以参考其代码结构。
  * **向量数据库**和检索部分可以集成现有云服务或库，如Pinecone、ElasticSearch+kNN插件，或开源Milvus等，结合LangChain的文档加载和检索工具，快速实现RAG流程。
  * 前端建议采用**现成的聊天UI组件**或框架（如对话机器人常用的React组件），并利用流式API让回答分段显示，提升交互体验。

* **分阶段实现核心功能**：按照**核心优先、迭代扩展**的策略开发：

  1. **原型验证阶段**：首先实现基本的单轮问答功能和知识库检索集成。构建一个简单对话界面，用户提问后系统调用GPT-4并从一两个预先处理的文档中检索附加内容，返回答案。此阶段目标是验证LLM结合本地资料能正确回答课程相关问题。可选取课程几个重点知识点测试，并调整Prompt以获取理想输出。
  2. **基础功能实现阶段**：扩充知识库至完整课程资料，完善RAG流程；同时实现核心智能体中的**答疑讲解助手**（用于一般问答）和**代码审查助手**两个功能模块。这两项一方面覆盖最主要的问答需求，另一方面验证LLM在代码分析场景的能力。实现调度模块基本逻辑，使其能根据文本内容简单判断调用哪种助手（如包含代码则走代码审查流程，否则走普通答疑流程）。这一阶段完成后，可以进行小规模试用，让几位师生反馈AI回答质量和代码审查效果，进一步优化提示模板和知识检索匹配。
  3. **扩展智能体阶段**：逐步实现其他智能体功能模块。建议优先次序：

     * **需求文档助手**、**类图助手**：这两者贴合软件工程教学重点，可尽早实现来帮助课程项目起步时的需求分析和设计环节。
     * **测试设计助手**、**文档格式助手**：随后实现，以支持中后期的测试环节和报告撰写环节。
     * **项目管理助手**、**进度追踪助手**：这些涉及数据汇总和时间管理，可以在前几项完成后并行开发。进度追踪需要从学生行为数据中分析，可与项目管理助手部分配合。
     * **学习建议助手**、**教学数据反馈助手**：可放在较后实现，因为它们主要汇总已有的数据和结果进行分析，相对不直接影响课程流程。等前面功能有了一定数据积累，再开发效果会更好。
  4. **整合测试阶段**：当所有主要智能体完成后，进行全面的系统集成测试。重点测试跨智能体协作的场景，如一个复杂请求触发多个助手连锁工作的情况，确保调度模块处理正确。还要进行性能测试（模拟多用户并发）和安全测试（模拟异常或攻击情况）来验证非功能需求达标。根据测试结果修复bug、优化性能。
  5. **部署和试运行阶段**：在实际课程中小范围试运行，或作为辅助工具供教师使用一段时间。收集真实用户的使用情况和反馈，持续改进。逐步扩大使用范围，最终全面用于课程教学。

* **研发资源与分工**：小团队可按模块分工协作：

  * 一部分成员专注于**对话系统和前端**，实现UI、对话管理与用户体验优化。
  * 一部分成员负责**后端架构和调度**，设计调度模块和智能体接口，确保各部分衔接顺畅。
  * 另有成员投入**知识库与检索**，处理数据预处理、向量索引和优化检索效果（例如调整embedding模型或fine-tune检索参数以提高相关性）。
  * 每个智能体功能的实现可以由擅长相关领域的人员负责。例如有前端经验的人可负责文档格式检查助手（涉及文档解析），有算法背景的人实现教学数据分析助手。
  * 模型提示工程（Prompt Engineering）和持续**质量调优**需要贯穿始终，可以由对LLM特性了解较深的成员主导，结合测试反馈不断改进提示词策略。

* **技术风险与缓解**：

  * LLM输出不稳定：若测试发现GPT-4对某些提问效果不佳，可考虑尝试Anthropic Claude或其他模型对比，或者通过**Few-shot示例**加强提示。此外，应预留替换模型的灵活性，以防API定价或政策变化影响。
  * 知识库检索不准确：可能需要调整分段策略或embedding模型选择。团队可针对课程典型问答手工检查检索结果，迭代优化。如必要可对关键术语建立**词汇索引**补充，确保专有名词也能被命中。
  * 多智能体协同复杂：调度策略需慎重设计，避免出现不同智能体给出冲突信息的情况。如果复杂度过高，小步迭代，甚至在早期先采用**串行**而非真正并行调用简化逻辑（例如任务顺序执行，每步结果写入上下文供下一个使用）。待系统成熟再开放完全并行模式。
  * API费用控制：频繁调用GPT-4会产生费用，应在开发阶段做预算和优化。例如对相似的请求结果做缓存，或对于知识库已有直接答案的问题减少模型调用（直接检索给答案）。教育场景可探索申请厂商优惠或赞助。

* **优先级划分**：从需求重要性和实现难度两方面考虑，初始版本的**必须实现**与**可延后实现**功能应加以区分：

  * **必须实现**：核心问答（含RAG）、代码审查、需求/设计相关助手、多轮对话。这些直接关系主要教学痛点，必须保证具备且效果达标。
  * **高优先级**：测试设计、项目管理、文档检查。这些对教学过程有重要帮助，且实现难度中等，应紧随核心功能开发。
  * **中优先级**：进度追踪、学习建议。这些功能锦上添花，但不影响基本教学流程，可在核心功能稳定后补上。
  * **低优先级**：教学数据反馈报告。一方面教师不一定强制需要AI提供数据分析（传统方式也能获取成绩统计），另一方面实现涉及多数据源整合和分析，有一定复杂度。可视实际时间，在后期完善或迭代更新中加入。

* **借鉴行业方案**：在具体实现时，多关注OpenAI、微软等最新发表的关于教学AI的方案和研究：

  * 微软近来推出的**教育版Copilot**或相关研究项目（如与教育平台合作的智能导师）可能提供宝贵经验，包括如何设计反馈方式、如何融入教师工作流等。
  * OpenAI社区中关于RAG和多智能体的讨论、范例代码（例如OpenAI Function calling API、planner-executor模式）都可作为蓝本，减少走弯路。
  * Anthropic的“Claude for Education”如有公开信息，可了解其在保证安全和有效教学上的特别措施，从而在本系统中借鉴类似的策略。

综上所述，本系统的开发应稳扎稳打，以**高效利用现有技术**和**聚焦教学价值**为原则。通过明确阶段目标和合理分工，小团队亦能完成这一创新的教学辅助系统。在实践中不断根据用户反馈调整优化，最终交付一个安全、可靠、功能丰富的智能学习助手，为软件工程课程教学赋能。

